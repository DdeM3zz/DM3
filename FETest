-- Клиентская часть
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local StarterGui = game:GetService("StarterGui")
local Workspace = game:GetService("Workspace")

local function showNotification(message, duration)
    pcall(function()
        StarterGui:SetCore("SendNotification", {
            Title = "Hat Sky Drop",
            Text = message,
            Duration = duration or 2
        })
    end)
end

local remoteEvent = nil
for _, child in pairs(ReplicatedStorage:GetChildren()) do
    if child:IsA("RemoteEvent") then
        remoteEvent = child
        showNotification("Найден RemoteEvent: " .. child.Name)
        break
    end
end

if not remoteEvent then
    remoteEvent = Instance.new("RemoteEvent")
    remoteEvent.Name = "HatSkyDropEvent"
    remoteEvent.Parent = ReplicatedStorage
    showNotification("Создан новый RemoteEvent: HatSkyDropEvent")
end

local function dropHatsFromSky()
    showNotification("Запуск падения кубов с неба...")
    local success, errorMsg = pcall(function()
        remoteEvent:FireServer("DropCubes")
    end)
    if success then
        showNotification("Запрос отправлен на сервер!")
    else
        showNotification("Ошибка отправки: " .. tostring(errorMsg))
    end
end

local UserInputService = game:GetService("UserInputService")
UserInputService.InputBegan:Connect(function(input, processed)
    if processed then return end
    if input.KeyCode == Enum.KeyCode.T then
        dropHatsFromSky()
    end
end)
